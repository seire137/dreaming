<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Player Blog</title>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/3.0.0/uicons-solid-rounded/css/uicons-solid-rounded.css'>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/3.0.0/uicons-regular-rounded/css/uicons-regular-rounded.css'>

    <style>
        body {
            margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center;
            min-height: 100vh; overflow-x: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: #4a4a4a; box-sizing: border-box;
        }

        #bgWrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background-size: cover; background-position: center;
            filter: blur(60px) brightness(0.7); transform: scale(1.3); transition: background-image 0.5s ease;
        }

        .player-card {
            width: 100%; max-width: 400px; padding: 25px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(30px);
            border-radius: 40px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            box-sizing: border-box;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            position: relative;
            margin-right: 40px;
        }

        /* 사이드바 컨트롤 */
        .side-controls {
            position: absolute; right: -55px; top: 50%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 25px; align-items: center;
        }

        .side-btn {
            background: none; border: none; color: white;
            font-size: 1.4rem; cursor: pointer; opacity: 0.6;
            transition: opacity 0.2s, transform 0.2s;
        }
        .side-btn:hover { opacity: 1; transform: scale(1.1); }
        .side-btn.active { opacity: 1; color: #ff2d55; }

        .album-art {
            width: 100%; aspect-ratio: 1 / 1; 
            border-radius: 20px; background-size: cover; background-position: center;
            margin-bottom: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            background-color: rgba(0,0,0,0.1);
        }

        .info-section {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; text-align: left;
        }
        .text-group { flex: 1; overflow: hidden; padding-right: 10px; }
        .song-name { font-size: 1.3rem; font-weight: 700; margin: 0; word-break: keep-all; }
        .pair-name { font-size: 1rem; opacity: 0.7; margin: 3px 0 0 0; }
        
        .wave-icon { font-size: 1.2rem; opacity: 0.5; color: white; }

        .progress-section { margin-bottom: 25px; }
        .progress-bar { 
            width: 100%; height: 5px; background: rgba(255,255,255,0.2); 
            border-radius: 10px; position: relative; margin-bottom: 8px;
        }
        .progress-current { width: 45%; height: 100%; background: white; border-radius: 10px; }
        .time-group { display: flex; justify-content: space-between; font-size: 0.75rem; opacity: 0.6; }

        .controls { display: flex; justify-content: space-around; align-items: center; margin-bottom: 10px; }
        .btn { background: none; border: none; color: white; font-size: 2rem; cursor: pointer; opacity: 0.9; }
        .btn-play { font-size: 3.2rem; }

        /* 하단 디바이스 버튼: My Blog 유지 */
        .device-selector {
            display: flex; justify-content: center; align-items: center;
            margin-top: 15px; font-size: 0.8rem;
        }
        .device-btn {
            background: rgba(255, 255, 255, 0.15); border: none; color: white;
            padding: 6px 15px; border-radius: 20px; cursor: pointer;
            display: flex; align-items: center; gap: 7px;
        }
    </style>
</head>
<body oncontextmenu="return false" ondragstart="return false" onselectstart="return false">

<div id="bgWrapper"></div>

<div class="player-card">
    <div class="side-controls">
        <button class="side-btn" id="heartBtn" onclick="toggleHeart()"><i class="fi fi-rr-heart"></i></button>
        <button class="side-btn" onclick="goHome()"><i class="fi fi-rr-music-alt"></i></button>
        <button class="side-btn" style="cursor: default; opacity: 0.4;"><i class="fi fi-rr-intercom"></i></button>
    </div>

    <div id="albumArt" class="album-art"></div>

    <div class="info-section">
        <div class="text-group">
            <h1 id="songName" class="song-name">로딩 중...</h1>
            <p id="pairName" class="pair-name">데이터 로드 중</p>
        </div>
        <div class="wave-icon"><i class="fi fi-rr-stats"></i></div>
    </div>
    
    <div class="progress-section">
        <div class="progress-bar"><div class="progress-current"></div></div>
        <div class="time-group"><span>3:13</span><span>-0:48</span></div>
    </div>

    <div class="controls">
        <button class="btn" onclick="prevPost()"><i class="fi fi-sr-rewind"></i></button> 
        <button class="btn btn-play" onclick="enterPost()"><i class="fi fi-sr-play"></i></button> 
        <button class="btn" onclick="nextPost()"><i class="fi fi-sr-forward"></i></button> 
    </div>

    <div class="device-selector">
        <button class="device-btn"><i class="fi fi-rr-computer"></i> My Blog</button>
    </div>
</div>

<script>
    let posts = [];
    let currentIndex = 0;
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycby6wtp_vKh5ie5SBSHY5x0LwlMWkPjeTbed5vy8UZUGXlrNmEzaWb483F-vh12LBJS3/exec';

    function loadData() {
        fetch(SHEET_URL)
            .then(response => response.json())
            .then(data => {
                posts = data;
                updatePlayer();
            })
            .catch(error => console.error('Error:', error));
    }

    function updatePlayer() {
        if (posts.length === 0) return;
        const post = posts[currentIndex];
        document.getElementById('songName').innerText = post.title || "제목 없음";
        document.getElementById('pairName').innerText = post.tags || "태그 없음";
        
        if (post.img) {
            const imgUrl = `url('${post.img}')`;
            document.getElementById('albumArt').style.backgroundImage = imgUrl;
            document.getElementById('bgWrapper').style.backgroundImage = imgUrl;
        }
    }

    function nextPost() { if (posts.length > 0) { currentIndex = (currentIndex + 1) % posts.length; updatePlayer(); } }
    function prevPost() { if (posts.length > 0) { currentIndex = (currentIndex - 1 + posts.length) % posts.length; updatePlayer(); } }
    function enterPost() { 
        if (posts.length > 0 && posts[currentIndex].url) window.location.href = posts[currentIndex].url;
    }
    function goHome() { window.location.href = 'index.html'; }
    function toggleHeart() {
        const btn = document.getElementById('heartBtn');
        btn.classList.toggle('active');
        const icon = btn.querySelector('i');
        icon.className = btn.classList.contains('active') ? 'fi fi-sr-heart' : 'fi fi-rr-heart';
    }

    loadData();
</script>

</body>
</html>
